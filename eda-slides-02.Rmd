---
title: "ODSC: Data Visualization with ggplot2"
subtitle: "Part 2: Creating graphs with ggplot2"
author: "Martin Frigaard"
institute: "California State University | BioMarin"
date: "`r Sys.Date()`"
output:
  xaringan::moon_reader:
    css:
      - default
      - css/lexis.css
      - css/lexis-fonts.css
    lib_dir: libs
    seal: false
    nature:
      highlightStyle: github
      highlightLines: true
      countIncrementalSlides: false
      ratio: "16:9"
---

```{r meta, echo=FALSE}
# infinite moon reader ----
# xaringan::inf_mr()
library(metathis)
meta() %>%
  meta_general(
    description = "ODSC: Data Visualization with ggplot2",
    generator = "xaringan and remark.js"
  ) %>%
  meta_name("github-repo" = "mjfrigaard/odsc-ggplot2-2022/tree/gh-pages") %>%
  meta_social(
    title = "ODSC: Data Visualization with ggplot2",
    url = "https://mjfrigaard.github.io/odsc-ggplot2-2022/",
    og_type = "website",
    og_author = "Martin Frigaard",
    twitter_card_type = "summary",
    twitter_creator = "@mjfrigaard"
  )
```

```{r setup, include=FALSE}
dateWritten <- format(as.Date("2022-02-08"), format = "%B %d %Y")
today <- format(Sys.Date(), format = "%B %d %Y")
library(knitr)
library(tidyverse)
library(fontawesome)
options(
  htmltools.dir.version = FALSE,
  knitr.table.format = "html",
  knitr.kable.NA = ""
)
knitr::opts_chunk$set(
  warning = FALSE,
  message = FALSE,
  fig.path = "images/",
  fig.width = 7.252,
  fig.height = 4,
  comment = "#>",
  fig.retina = 3 # Better figure resolution
)
# Enables the ability to show all slides in a tile overview by pressing "o"
xaringanExtra::use_tile_view()
xaringanExtra::use_panelset()
xaringanExtra::use_clipboard()
xaringanExtra::use_share_again()
xaringanExtra::style_share_again(share_buttons = "all")
xaringanExtra::use_extra_styles(
  hover_code_line = TRUE,
  mute_unhighlighted_code = FALSE
)
```

layout: true

<!-- this adds the link footer to all slides, depends on footer-small class in css-->

<div class="footer-small"><span>https://github.com/mjfrigaard/talks/tree/main/odsc-eda-2022-04</span></div>

---
name: title-slide
class: title-slide, center, middle, inverse

# `r rmarkdown::metadata$title`
#.fancy[`r rmarkdown::metadata$subtitle`]

<br>

.large[by Martin Frigaard]

Written: `r dateWritten`

Updated: `r today`

---
class: left, top, inverse
background-image: url(images/ODSC_Logo_2020.png)
background-position: 95% 8%
background-size: 12%

# Resources 

<br>

.leftcol[

## Links:

### - [Conference Website](https://odsc.com/boston/)

### - [Website](https://mjfrigaard.github.io/odsc-ggplot2-2022/)

### - [Part 1](https://mjfrigaard.github.io/odsc-ggplot2-2022/eda-slides-01.html#1)

### - [Part 2](https://mjfrigaard.github.io/odsc-ggplot2-2022/eda-slides-02.html#1)

]

.rightcol[

## Materials:

### - [RStudio.Cloud](https://rstudio.cloud/spaces/225054/project/3704185)

### - [Github Repo](https://github.com/mjfrigaard/odsc-ggplot2-2022/tree/gh-pages) 

]

---
class: left, top, inverse
background-image: url(images/ODSC_Logo_2020.png)
background-position: 95% 8%
background-size: 12%

## Outline 

.leftcol[

### Part 1

**Exploratory Data Analysis**

- *What is it, who does it, and why it's important*

**A Bayesian Mindset**

- *Priors -> new information -> posteriors*

**The grammar of graphics**

- *Layers, aesthetics, and geoms*

]

--
 
.rightcol[

### .red[Part 2]

**Graphs & mental models**

- *Mental representations graph elements*

**Creating graphs with ggplot2**

- *Build from scratch, layer-by-layer*

**.fancy[Re]-creating graphs with ggplot2**

- *Mapping data to graph elements*

]

---
class: center, middle, inverse
background-image: url(images/ODSC_Logo_2020.png)
background-position: 95% 8%
background-size: 12%

# .fancy[.large[PART 2]]

--

#### .left[*Tip: writing code can be frustrating, especially in the beginning...*]

--

#### .center[*...it doesn't always produce a tangible result...*]

--

#### .right[*...but creating visualizations is rewarding!!!*]


---
class: left, top, inverse
background-image: url(images/ODSC_Logo_2020.png)
background-position: 95% 8%
background-size: 12%

# `ggplot2`: before we start

<br>

### **Build the labels first!**

#### Create a title, subtitle (with data source), and x/y axis labels 

--

.leftcol60[.code60[

```{r labs_pengiuns, eval=FALSE}
labs_pengiuns <- ggplot2::labs(
              title = "Flipper vs. Bill Length", 
              subtitle = "source: palmerpenguins::penguins", 
              x = "flipper length (mm)", 
              y = "bill length (mm)")
```

]]

--

.rightcol40[

.center[.large[.red[<- our expectations]]]

]

---
class: left, top, inverse
background-image: url(images/ODSC_Logo_2020.png)
background-position: 95% 8%
background-size: 12%


# `ggplot2`: build graph, check labels


.leftcol40[.code50[

```{r labs_pengiuns-penguins, echo=FALSE}
penguins <- palmerpenguins::penguins
```

```{r penguins, fig.show='hide'}
labs_pengiuns <- ggplot2::labs(
    title = "Flipper vs. Bill Length", 
    subtitle = "source: palmerpenguins::penguins", 
    x = "flipper length (mm)", 
    y = "bill length (mm)") 

ggplot(data = penguins, 
       mapping = aes(x = bill_length_mm, 
                     y = flipper_length_mm) 
       ) + 
  labs_pengiuns #<<
```


]]

--

.rightcol60[

```{r plot-penguins, ref.label='penguins', echo=FALSE, fig.align='center', out.width='100%', out.height='100%'}

```

### .red[What's wrong here?]


]


---
class: left, top, inverse
background-image: url(images/ODSC_Logo_2020.png)
background-position: 95% 8%
background-size: 12%


## `ggplot2`: build graph, check labels, .red[revise]

--

.leftcol40[.code50[

```{r palmerpenguins-penguins, echo=FALSE}
penguins <- palmerpenguins::penguins
```

```{r penguins-revise, fig.show='hide'}
labs_pengiuns <- ggplot2::labs(
    title = "Flipper vs. Bill Length", 
    subtitle = "source: palmerpenguins::penguins", 
    x = "flipper length (mm)", #<<
    y = "bill length (mm)") #<<

ggplot(data = penguins, 
       mapping = aes(x = flipper_length_mm, #<<
                     y = bill_length_mm) #<<
       ) + 
  labs_pengiuns
```

]]

--

.rightcol60[

```{r plot-penguins-revise, ref.label='penguins-revise', echo=FALSE, fig.align='center', out.width='100%', out.height='100%'}

```

## .green[FIXED!!!]

]


---
class: left, top, inverse
background-image: url(images/ODSC_Logo_2020.png)
background-position: 95% 8%
background-size: 12%


## `ggplot2`: build graph, check labels, .red[REVISE]

> .blue[*Revision Sharpens Thinking: More particularly, rewriting is the key to improved thinking.*]

--

> .blue[*It demands a real open-mindedness and objectivity. It demands a willingness to cull verbiage so that ideas stand out clearly. And it demands a willingness to meet logical contradictions head on and trace them to the premises that have created them.*] 

--

> .red[*In short, it forces a writer to get up his courage and expose his thinking process to his own intelligence.* — Marvin H. Swift, HBR [Clear Writing Means Clear Thinking Means…](https://hbr.org/1973/01/clear-writing-means-clear-thinking-means)]


---
class: center, middle
background-image: url(images/ODSC_Logo_2020.png)
background-position: 95% 8%
background-size: 12%

# **.fancy[.darkblue[.large[Layers, aesthetics, and geoms]]]**

## Let's get started!

---
class: left, top, inverse
background-image: url(images/ODSC_Logo_2020.png)
background-position: 97% 6%
background-size: 10%

# RStudio.Cloud: Set up

## In your RStudio.Cloud, you will see the following: 

```{r rscloud-landing, echo=FALSE, fig.align='center', out.height='90%', out.width='90%'}
knitr::include_graphics("images/rscloud-landing.png")
```

## Click on .red[odsc-ggplot2-2022] project

---
class: left, top, inverse
background-image: url(images/ODSC_Logo_2020.png)
background-position: 97% 6%
background-size: 10%

# RStudio.Cloud: Set up

## In your RStudio IDE, you will see the following: 

```{r rscloud-env, echo=FALSE, fig.align='center', out.height='80%', out.width='80%'}
knitr::include_graphics("images/rscloud-env.png")
```

---
class: left, top, inverse
background-image: url(images/ODSC_Logo_2020.png)
background-position: 97% 6%
background-size: 10%

# RStudio.Cloud: Set up

## In the .blue[Files] pane, click on the `inst.R` file to open it

```{r rscloud-open-inst, echo=FALSE, fig.align='center', out.height='80%', out.width='80%'}
knitr::include_graphics("images/rscloud-open-inst.png")
```


---
class: left, top, inverse
background-image: url(images/ODSC_Logo_2020.png)
background-position: 97% 6%
background-size: 10%

# RStudio.Cloud: Set up

## In the .blue[Source] pane, click on the .blue[Source] icon to run `inst.R`

```{r rscloud-source-inst, echo=FALSE, fig.align='center', out.height='80%', out.width='80%'}
knitr::include_graphics("images/rscloud-source-inst.png")
```


---
class: left, top, inverse
background-image: url(images/ODSC_Logo_2020.png)
background-position: 97% 6%
background-size: 10%

# RStudio.Cloud: Exercises 

## The exercises are in the `graphs/` folder 

```{r graphs-files, echo=FALSE, fig.align='center', out.height='80%', out.width='80%'}
knitr::include_graphics("images/graphs-files.png")
```

---
class: left, top, inverse
background-image: url(images/ODSC_Logo_2020.png)
background-position: 97% 6%
background-size: 10%

# RStudio.Cloud: Solutions 

## Each exercise has a solution file in `solutions/` folder

```{r sols-files, echo=FALSE, fig.align='center', out.height='80%', out.width='80%'}
knitr::include_graphics("images/sols-files.png")
```


---
class: left, top, inverse
background-image: url(images/ODSC_Logo_2020.png)
background-position: 97% 6%
background-size: 10%

# .red[graph-01]: The data layer

We're going to use the `palmerpenguins::penguins`

Below are some options for viewing the data:

--

.cols3[.code90[

```{r view-penguins, eval=FALSE}
View(penguins)
```


]]

.cols3[.code90[

```{r glimpse-penguins, eval=FALSE}
glimpse(penguins)
```

]]


.cols3[.code90[

```{r str-penguins, eval=FALSE}
str(penguins)
```

]]

---
class: left, top, inverse
background-image: url(images/ODSC_Logo_2020.png)
background-position: 97% 6%
background-size: 10%

# .red[graph-01]: The data layer

## `View()` opens the RStudio data viewer

```{r penguins-View, echo=FALSE, fig.align='center', out.height='80%', out.width='80%'}
knitr::include_graphics("images/penguins-View.png")
```


---
class: left, top, inverse
background-image: url(images/ODSC_Logo_2020.png)
background-position: 97% 6%
background-size: 10%

# .red[graph-01]: The data layer

## `glimpse()` and `str()` are displayed in the console

.leftcol[

```{r penguins-glimpse, echo=FALSE, fig.align='center', out.height='100%', out.width='100%'}
knitr::include_graphics("images/penguins-glimpse.png")
```

]

.rightcol[

```{r penguins-str, echo=FALSE, fig.align='center', out.height='100%', out.width='100%'}
knitr::include_graphics("images/penguins-str.png")
```

]


---
class: left, top, inverse
background-image: url(images/ODSC_Logo_2020.png)
background-position: 97% 6%
background-size: 10%

# .red[graph-01]: Initialize plot with data


.leftcol[

Recall our template from Part 1:

.code60[

```{r template-01, eval=FALSE, echo=TRUE}
ggplot(data = <DATA>) +
     geom_*(mapping = aes(<AESTHETIC MAPPINGS>)) 
```

]
]

--

.rightcol[

Replace `<DATA>` with `penguins`

.code60[

```{r initialize}
ggplot(data = penguins) #<<
```

]
]

---
class: left, top, inverse
background-image: url(images/ODSC_Logo_2020.png)
background-position: 97% 6%
background-size: 10%

# .red[graph-01]: Build labels! 

We want to build the labels *before* mapping variables 

- title = "Bill and flipper length of Palmer penguins"
- subtitle = "Size measurements for adult foraging penguins"
- x = "Bill length (mm)"
- y = "Flipper length (mm)"

```{r labs_g01, eval=TRUE}
# build labels 
labs_bill_vs_flippper <- ggplot2::labs(
  title = "Bill and flipper length of Palmer penguins", 
  subtitle = "Size measurements for adult foraging penguins",
  x = "Bill length (mm)", 
  y = "Flipper length (mm)")
```


---
class: left, top, inverse
background-image: url(images/ODSC_Logo_2020.png)
background-position: 97% 6%
background-size: 10%

# .red[graph-01]: Map variables to positions

Now that we have our labels, we know where to put our variables

.leftcol[
.code60[

Refer to template:

```{r , eval=FALSE}
ggplot(data = <DATA>) +
     geom_*(mapping = aes(x = <AESTHETIC MAPPINGS>,
                          y = <AESTHETIC MAPPINGS>)) 
```

Map `x` and `y`

```{r g01-position, fig.show='hide'}
ggplot(data = penguins, 
       mapping = aes(x = bill_length_mm, #<<
                     y = flipper_length_mm)) #<<
```

]
]

--

.rightcol[

Mapping variables *outside* `geom_*` functions gives us a blank canvas!

```{r g01-position-out, ref.label='g01-position', echo=FALSE, fig.align='center', out.width='100%', out.height='100%'}

```

]

---
class: left, top, inverse
background-image: url(images/ODSC_Logo_2020.png)
background-position: 97% 6%
background-size: 10%

# .red[graph-02]: Adding geoms


.leftcol[

Add the `geom_point()` function (use the `+` symbol)

.code60[

```{r g02-geom, fig.show='hide'}
ggplot(data = penguins, 
       mapping = aes(x = bill_length_mm, 
                     y = flipper_length_mm)) + 
       geom_point() #<<
```


]
]

--

.rightcol[

The `geom_point()` function tells R we want to see the points (or dots) on our canvas

```{r g02-geom-out, ref.label='g02-geom', echo=FALSE, fig.align='center', out.width='100%', out.height='100%'}

```

]


---
class: left, top, inverse
background-image: url(images/ODSC_Logo_2020.png)
background-position: 97% 6%
background-size: 10%

# .red[graph-02]: Don't forget the labels! 


.leftcol[

Finally, we want to add the labels we created (`labs_bill_vs_flippper`)

.code60[

```{r g02-labels, fig.show='hide', eval=FALSE}
ggplot(data = penguins, 
       mapping = aes(x = bill_length_mm, 
                     y = flipper_length_mm)) + 
  geom_point() + 
  labs_bill_vs_flippper #<<
```


]
]

--

.rightcol[

Now we have our first graph!

```{r g02-labels-out, echo=FALSE, fig.align='center', out.width='100%', out.height='100%'}
ggplot(data = penguins, 
       mapping = aes(x = bill_length_mm, 
                     y = flipper_length_mm)) + 
  geom_point() + 
  labs_bill_vs_flippper #<<
```

]


---
class: left, top, inverse
background-image: url(images/ODSC_Logo_2020.png)
background-position: 97% 6%
background-size: 10%

# .red[graph 03]: Global vs. local mapping

.leftcol[

We've just created a graph by setting global aesthetics 

.code60[

```{r global, eval=FALSE}
ggplot(data = penguins, 
       mapping = aes(x = bill_length_mm, #<<
                     y = flipper_length_mm)) + #<<
  geom_point() + 
  labs_bill_vs_flippper
```

We can also set aesthetics locally (*inside* the `geom_*` function)

```{r g03-local, fig.show='hide'}
ggplot(data = penguins) + 
  geom_point( #<<
    mapping = aes(x = bill_length_mm, #<<
                  y = flipper_length_mm)) + #<<
  labs_bill_vs_flippper
```


]
]

--

.rightcol[

This creates the same plot. 

```{r g03-local-out, ref.label='g03-local', echo=FALSE, fig.align='center', out.width='100%', out.height='100%'}

```

Read more [here](https://ggplot2-book.org/collective-geoms.html#different-groups-on-different-layers).

]



---
class: left, top, inverse
background-image: url(images/ODSC_Logo_2020.png)
background-position: 97% 6%
background-size: 10%

# .red[graph-04]: Using color 


---
class: left, top, inverse
background-image: url(images/ODSC_Logo_2020.png)
background-position: 97% 6%
background-size: 10%

# .red[graph-05]: Multiple geoms



---
class: left, top, inverse
background-image: url(images/ODSC_Logo_2020.png)
background-position: 97% 6%
background-size: 10%

# .red[graph-06]: Multiple geoms



---
class: center, middle
background-image: url(images/ODSC_Logo_2020.png)
background-position: 95% 8%
background-size: 12%

# **.fancy[.darkblue[.large[Creating Graphs with .red[ggplot2]]]]**


---
class: left, top, inverse
background-image: url(images/ODSC_Logo_2020.png)
background-position: 97% 6%
background-size: 10%

# .red[graph 04]: Creating graphs 

<br>

## The data 

---
class: left, top, inverse
background-image: url(images/ODSC_Logo_2020.png)
background-position: 97% 6%
background-size: 10%

# .red[graph 04]: Creating graphs 

<br>

## The data 

---
class: left, top, inverse
background-image: url(images/ODSC_Logo_2020.png)
background-position: 97% 6%
background-size: 10%

# .red[graph 05]: Creating graphs 

<br>

## Graph labels

---
class: left, top, inverse
background-image: url(images/ODSC_Logo_2020.png)
background-position: 97% 6%
background-size: 10%


# .red[graph 06]: Creating graphs 

<br>

## A blank canvas

---
class: left, top, inverse
background-image: url(images/ODSC_Logo_2020.png)
background-position: 97% 6%
background-size: 10%

# .red[graph 07]: Creating graphs 

<br>

## Geoms and mapping

---
class: left, top, inverse
background-image: url(images/ODSC_Logo_2020.png)
background-position: 97% 6%
background-size: 10%

# .red[graph 07]: Creating graphs 

<br>

## Geoms and mapping

---
class: left, top, inverse
background-image: url(images/ODSC_Logo_2020.png)
background-position: 97% 6%
background-size: 10%

# .red[graph 08]: Creating graphs 

<br>

## Add labels

---
class: left, top, inverse
background-image: url(images/ODSC_Logo_2020.png)
background-position: 97% 6%
background-size: 10%

# .red[graph 09]: Creating graphs 

<br>

## Saving graphs

---
class: left, top, inverse
background-image: url(images/ODSC_Logo_2020.png)
background-position: 97% 6%
background-size: 10%

# .red[graph 10]: Creating graphs 

<br>

## Saving graphs


---
class: center, middle
background-image: url(images/ODSC_Logo_2020.png)
background-position: 95% 8%
background-size: 12%

# **.fancy[.darkblue[.large[.blue[Re]-creating Graphs with .red[ggplot2]]]]**

---
class: left, top, inverse
background-image: url(images/ODSC_Logo_2020.png)
background-position: 97% 6%
background-size: 10%

# `ggplot2`: .green[Re]-creating graphs 

---
class: left, top, inverse
background-image: url(images/ODSC_Logo_2020.png)
background-position: 97% 6%
background-size: 10%

# `ggplot2`: .green[Re]-creating graphs 

---
class: left, top, inverse
background-image: url(images/ODSC_Logo_2020.png)
background-position: 97% 6%
background-size: 10%

# `ggplot2`: .green[Re]-creating graphs 

---
class: left, top, inverse
background-image: url(images/ODSC_Logo_2020.png)
background-position: 97% 6%
background-size: 10%

# `ggplot2`: .green[Re]-creating graphs 

---
class: left, top, inverse
background-image: url(images/ODSC_Logo_2020.png)
background-position: 97% 6%
background-size: 10%

# `ggplot2`: .green[Re]-creating graphs 

---
class: left, top, inverse
background-image: url(images/ODSC_Logo_2020.png)
background-position: 97% 6%
background-size: 10%

# `ggplot2`: .green[Re]-creating graphs 


---
class: left, top, inverse
background-image: url(images/ODSC_Logo_2020.png)
background-position: 95% 8%
background-size: 12%

# `ggplot2`: templates


.leftcol55[

### Basic Template: Data, aesthetic mappings, geom

.code70[

```{r , eval=FALSE, echo=TRUE}
ggplot(data = <DATA>) +
     geom_*(mapping = aes(<AESTHETIC MAPPINGS>)) 
```

]
]

.rightcol45[

<br>

```{r , eval=TRUE, echo=FALSE, fig.align='center', out.height='83%', out.width='83%'}
knitr::include_graphics("images/layer-breakdown-01.png")
```

]

---
class: center, middle, inverse, no-slide-number
background-image: url(images/ODSC_Logo_2020.png)
background-position: 95% 8%
background-size: 12%

# Thanks!

.footer-large[
.right[
[@mjfrigaard `r fa(name = "twitter", fill = "white")`](http://twitter.com/mjfrigaard)<br>
[@mjfrigaard `r fa(name = "github", fill = "white")`](http://github.com/mjfrigaard)<br>
[mjfrigaard@pm.e `r fa(name = "paper-plane", fill = "white")`](mailto:mjfrigaard@pm.me)<br>
[What does "λέξις" mean?](https://jhelvy.github.io/lexis/index.html#what-does-%CE%BB%CE%AD%CE%BE%CE%B9%CF%82-mean)
]]

